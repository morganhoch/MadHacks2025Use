{% extends "base.html" %}

{% block title %}Profile - ConnectU{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="profile-header">
        <div class="avatar">
            <img src="{{ user.avatar_url or url_for('static', filename='default_avatar.png') }}" alt="Avatar">
        </div>
        <div class="profile-info">
            <h2>{{ user.username }}</h2>
            <p>{{ user.email }}</p>
        </div>
    </div>
<div class="profile-details">
    <h3>Bio</h3>
    <p>{{ user.bio or "No bio yet." }}</p>

    <h3>Availability</h3>
    {% if user.available_times %}
      <ul>
        {% for day, times in user.available_times.items() %}
          {% if times %}
            <li>
              <strong>{{ day }}:</strong>
              <ul style="list-style-type: disc; margin-left: 20px; display: inline-block; margin: 0;">
                {% for time in times %}
                  <li style="display: inline; margin-right: 12px;">{{ time }}</li>
                {% endfor %}
              </ul>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    {% else %}
      <p>Not set yet.</p>
    {% endif %}    

    <h3>Personal Links</h3>
    {% if user.personal_links %}
        <ul>
        {% for link in user.personal_links.split(',') %}
            <li><a href="{{ link.strip() }}" target="_blank">{{ link.strip() }}</a></li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No links provided.</p>
    {% endif %}
</div>


    <div class="profile-actions">
        <a href="{{ url_for('edit_profile') }}" class="btn-primary">Edit Profile</a>
        <a href="{{ url_for('messaging.direct_message', recipient_id=user.id) }}" class="btn-secondary">Message</a>
    </div>

    <!-- Joined Classes -->
    <div class="profile-classes">
        <h3>Joined Classes</h3>
        {% if user_courses %}
            <ul>
            {% for uc in user_courses %}
        <li>
            <a href="{{ url_for('course_detail', course_code=uc.course.course_code) }}">
                {{ uc.course.course_code }}
                â€“ {{ uc.status }} ({{ uc.term }})
            </a>
        </li>
        {% endfor %}
            </ul>
        {% else %}
            <p>You haven't joined any classes yet.</p>
        {% endif %}
    </div>
</div>
{% endblock %}
